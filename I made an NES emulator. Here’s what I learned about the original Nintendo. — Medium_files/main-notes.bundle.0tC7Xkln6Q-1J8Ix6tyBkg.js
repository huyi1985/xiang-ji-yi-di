(function(z){
var s7=function(a,b){a.Qa&&z.ld(a.Qa,"u-hide",b)};var zda=function(a,b){return a.pc&&z.iy(a.pc,b)};var Ada=function(a,b){a.et=b};
var Bda=function(a,b){z.ct(a,7);var c=new z.Gs("",1,a.X());b.forEach(function(a){z.Zs(c,z.Ft(a.startOffset,a.endOffset,[a.quoteId],[a.userId]))},a);for(var d=z.At(c),e=z.Bt(c,d),g=0;g<d.length;g++){var h=e[g];if(h.length){for(var k={},m=[],q=0;q<h.length;q++){var u=h[q];k[z.D(u,"creatorIds")]=!0;m.push(u.getName())}h=d[g];q=g<d.length-1?d[g+1]:a.X().length;z.Zs(a,z.Ft(h,q,m,Object.keys(k)))}}};var t7=function(a){return z.D(a,"replies")};var u7=function(){return(0,z.M)("Tap to leave a recommend note.")};
var v7=function(){return(0,z.M)("This note is only visible to the author, anyone @ mentioned, and publication editors (if any). The author or editors can choose to make it public.")};var w7=function(a,b,c){this.range=a;this.anchor=b;this.Yq=b.getAttribute("name");this.highlight=c};
var x7=function(a,b,c){z.qz.call(this);this.BL={};this.TK={};this.yt={};this.Zl=null;this.aa=a;this.pi=a.get("request");this.U=a.get("routeBuilder");this.oa=a.get("modelStore");this.Ca=b;this.YL=0;this.Nl=c;this.eK=!1;this.dg=null;this.bb="";this.ZP=null};var y7=function(a,b){var c=a.BL[b];c||(c=a.BL[b]=new z.cR,a.S("new_note_list",c,a));return c};
var Cda=function(a,b){if(!b)return!1;var c=b.X();if(a.content==c.substring(a.startIndex,a.endIndex))return!0;var d=new RegExp(z.Pa(a.content),"gi"),e=d.exec(c),c=e&&d.exec(c);return e&&!c?(c=a.endIndex-a.startIndex,a.startIndex=e.index,a.endIndex=e.index+c,a.content=e[0],!0):!1};
var Dda=function(a,b,c){var d=b.Lb(),e=y7(a,b.Ec()),g=e?e.indexOf(b):-1,h=b.Oj();b.Zf(c);"HIDDEN"==c?a.oa.remove(b):b=z.eB(a.oa,b);var k=e?e.indexOf(b):-1;return{pe:a.pi.put(z.w(a.U,z.a4,{postId:a.Ca,noteId:d}),{state:c},{la:!0}),GQ:function(){b.Zf(h);-1==k&&(-1==g?e.add(b):e.gu(b,g))}}};var Eda=function(a,b,c){return a.pi.put(z.w(a.U,z.d4,{postId:a.Ca,noteId:c,replyId:b}),{state:"HIDDEN"},{la:!0})};
var Fda=function(a,b){var c=z.iy(a,"title");c&&b.call(void 0,c);(c=z.iy(a,"subtitle"))&&b.call(void 0,c);a.querySelector(".postField--body")&&z.LB(a.querySelector(".postField--body"),z.IB,z.ac(b,z.Yb(!0)),void 0)};var z7=function(a){var b;b=String(a).replace(/(\r\n|\r|\n)/g,"\x3cbr\x3e");return z.Aq(a,z.Dq)?(0,z.M)(b,z.Bq(a)):b};var A7=function(a,b,c){for(var d={},e=0;e<a.length;e++){var g=a[e],h=b.call(c,g,e,a);z.ba(h)&&(d[h]||(d[h]=[])).push(g)}return d};
var B7=function(a,b,c){z.sz.call(this);if(!a)throw Error("Missing element for TemplateView");this.Qa=a;this.ji=b;this.XM=c;this.gV="list"+z.oa(this);this.eL=""};var C7=function(a,b){a.eu=b;a.mC="note";a.$a()&&D7(a);return a};var D7=function(a,b){var c=!!b;if(a.$a()&&c)for(var c=a.ji.Cd(),d=0;d<c.length;d++){var e=E7(a,c[d]);a.S("after-draw",c[d],e)}};var F7=function(a,b){var c=a.pL.call(null,b);return a.eu?(a.eu[a.mC]=c,c=z.ux(a.XM,a.eu),delete a.eu[a.mC],String(c)):String(z.ux(a.XM,c))};
var G7=function(a,b){var c=a.Qa.querySelector("#"+H7(a,b));a.S("before-clear",b,c);c.innerHTML=F7(a,b);a.S("after-draw",b,c)};var E7=function(a,b,c){var d=window.document.createElement("div");d.className=a.eL;d.id=H7(a,b);d.innerHTML=F7(a,b);z.Qe(a.Qa,d,"undefined"!=typeof c?c:a.Qa.children.length);return d};var H7=function(a,b){var c=b.D(),d=b.C();if(!c||!d)throw Error("Unable to generate id "+b);return a.gV+c+d};var I7=function(a){this.wq=a};var J7=function(a,b){return b?z.iy(a.wq,b):null};
var K7=function(a,b,c){Fda(a.wq,function(a){var e=a.getAttribute("name");e&&b.call(c,a,e)})};var L7=function(a,b){return z.af(a.wq,b)?a.wq:null};var M7=function(a,b){var c;c=L7(a,b);return(c=z.Rx(b,z.IB,c))&&c.getAttribute("name")||null};var N7=function(a,b,c){(a=z.HB(c,L7(a,c)))&&z.ld(b,"is-darkBackgrounded",z.hd(a,"is-darkBackgrounded"))};var O7=function(a,b,c,d){z.aR.call(this,a,b,"Leave a note",400,d||null);this.Ca=c;this.U=a.get("routeBuilder")};
var Gda=function(a,b,c){a.PB=b;a.IJ=c.text;a.QB=c.image};var Hda=function(a,b,c,d){a.aD=b;a.$C=c;a.SK=d};
var P7=function(a,b,c){b='\x3cdiv class\x3d"js-quotesList u-xs-hide"\x3e'+(a.Kca?"":z.P(z.bN({title:"Highlights",Dd:(0,z.U)(""+z.P(z.$M({href:(0,z.T)(""+z.S((0,z.Xt)("https://medium.com/the-story/introducing-highlights-a4df69e8ed43"))),AA:"Learn more",fc:!0},c)))})))+'\x3cul class\x3d"list list--quotes list--short '+(a.YH.length?"":"is-empty")+'"\x3e';for(var d=a.YH,e=d.length,g=0;g<e;g++){for(var h=d[g],k="",m=h.quotes,q=m.length,u=0;u<q;u++)k+=""+m[u].quoteId+(u!=q-1?",":"");k=z.Qq(k);b+='\x3cli class\x3d"list-item list-item--inline" data-quote-ids\x3d"'+
z.R(k)+'" data-quote-creator-id\x3d"'+z.R(h.user.userId)+'"\x3e'+z.P(z.RM(z.N(a,{user:h.user}),c))+"\x3c/li\x3e"}return(0,z.M)(b+"\x3c/ul\x3e\x3c/div\x3e")};
var Ida=function(a,b,c){return(0,z.M)('\x3cdiv\x3e\x3cdiv class\x3d"buttonSet buttonSet--highlightMenu"\x3e'+z.P(z.pF({action:"quote",source:"quote_popover",icon:"icon--highlighter",ba:"button--highlightMenu js-quoteAttributions-pileOn",md:!0,Ta:!0,$a:a.$a},c))+(c.variants.enable_quote_responses&&c.supportsEdit?z.P(z.pF({action:"quote-respond",source:"quote_popover",icon:"icon--responseBubble",ba:"button--highlightMenu",md:!0,Ta:!0},c)):"")+'\x3cdiv class\x3d"buttonSet-separator"\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"js-quoteAttributions-info quoteAttributions-info"\x3e'+
Q7(a,0,c)+"\x3c/div\x3e\x3c/div\x3e")};var Q7=function(a,b,c){b=z.M;a=a.s1?"Top highlight":(0,z.M)(z.P(z.MN(z.N(a,{uH:!0,ZQ:!0}),c))+(1==a.Oe&&a.$a?" highlighted":""));return b(a)};
var Jda=function(a,b,c){return(0,z.M)('\x3cspan class\x3d"onboardingText"\x3e\x3ch4 class\x3d"onboardingText-title"\x3eThis is a highlight\x3c/h4\x3eSelect text and click \x3cspan class\x3d"icon icon--highlighter"\x3e\x3c/span\x3e to create your own.\x3cbr\x3eHighlights show the author and your followers that you value this bit.\x3c/span\x3e'+z.P(z.wL({cv:!0,Z:"Done",ed:"done"},c)))};var Kda=function(a,b,c){return(0,z.M)('\x3cdiv class\x3d"paragraphControls u-noUserSelect"\x3e'+R7(a,0,c)+"\x3c/div\x3e")};
var R7=function(a,b,c){b=z.M;var d='\x3cdiv class\x3d"notesMarker u-noUserSelect '+(0<a.Yr&&0==a.Wj?" u-xs-hide":"")+'" data-action\x3d"select-anchor" data-action-value\x3d"'+z.R(a.Yq)+'"\x3e'+S7(a,c)+"\x3c/div\x3e",e,g=""+(1==a.iP&&(a.CA||a.NA)?a.CA&&a.NA?" highlighted and commented":a.NA?" highlighted":a.CA?" commented":"":""),g=z.Qq(g);e='\x3cspan class\x3d"paragraphControls-itemText paragraphControls-itemText--social"\x3e';c=""+z.P(z.MN(z.N(a,{social:a.j1,$a:a.CA||a.NA,Oe:a.iP,uH:!0,D2:!0}),c))+
z.L(g);c=(0,z.U)(c);e+=z.P(z.QN(z.N(a,{text:c})))+"\x3c/span\x3e";a=(0,z.M)(e);return b(d+a)};
var S7=function(a,b){return(0,z.M)("remove"==a.Wj?'\x3cspan class\x3d"notesMarker-icon icon icon--notes"\x3e\x3c/span\x3e\x3cspan class\x3d"icon icon--remove"\x3e\x3c/span\x3e':a.Wj||a.Yr?b.variants.enable_quotes&&b.variants.combined_margin_quotes&&0==a.Wj?'\x3cspan class\x3d"notesMarker-icon icon icon--quotes"\x3e\x3c/span\x3e\x3cspan class\x3d"notesMarker-count"\x3e'+z.L(a.Yr)+"\x3c/span\x3e":'\x3cspan class\x3d"notesMarker-icon icon icon--notes"\x3e\x3c/span\x3e\x3cspan class\x3d"notesMarker-count u-showOnMobile"\x3e'+z.L(a.Wj)+
'\x3c/span\x3e\x3cspan class\x3d"notesMarker-count u-xs-hide"\x3e'+z.L(a.Wj+a.Yr)+"\x3c/span\x3e":'\x3cspan class\x3d"notesMarker-icon icon icon--notesHollow"\x3e\x3c/span\x3e\x3cspan class\x3d"notesMarker-nocount"\x3e+\x3c/span\x3e')};
var Lda=function(a,b,c){return(0,z.M)(z.P(z.oF({ba:"button--dismissNotes",action:"dismiss-note",text:(0,z.U)(""+S7({Wj:"remove"},c))},c))+'\x3cdiv class\x3d"notesList js-notesList"\x3e'+(c.variants.enable_quotes&&c.variants.combined_margin_quotes?z.P(P7({YH:[]},0,c))+z.P(z.bN({title:"Notes",Ni:!0,a1:!0})):"")+'\x3cdiv class\x3d"notesItems"\x3e\x3c/div\x3e\x3cdiv class\x3d"newNoteEditor" tabIndex\x3d"-1"\x3e'+z.P(z.oF({ba:"button--addNotes",action:"start-note",source:"new_note",md:!0,title:"Leave a note",
text:(0,z.U)('\x3cspan class\x3d"icon icon--addCircled icon--addNotes"\x3e\x3c/span\x3e\x3cspan class\x3d"notesAddText"\x3eLeave a note for \x3cspan class\x3d"js-notesPostCreator"\x3e\x3c/span\x3e\x3c/span\x3e\x3cspan class\x3d"notesAddCreatorText"\x3eLeave a note\x3c/span\x3e')},c))+(c.isAuthenticated?'\x3cdiv class\x3d"notesEditContainer is-notesEditMode"\x3e\x3cdiv class\x3d"notesAvatar"\x3e'+z.P(z.RM({Pf:!0,user:c.currentUser},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e'+z.L(c.currentUser.name)+
'\x3c/div\x3e\x3cdiv class\x3d"notesItemEditor notesEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+z.P(z.oF({isPrimary:!0,wA:!0,ba:"button--editNotesAction",action:"save-note",text:"Save"},c))+z.P(z.oF({ba:"button--editNotesAction",action:"cancel-note",text:"Cancel"},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesDisclaimer"\x3e'+z.P(v7())+"\x3c/div\x3e\x3c/div\x3e":"")+"\x3c/div\x3e\x3c/div\x3e")};
var Mda=function(a,b,c){var d=a.note.author?a.note.author.userId:null;b='\x3cdiv class\x3d"notesItem-inner"\x3e\x3cdiv class\x3d"notesItem-main"\x3e'+('\x3cdiv class\x3d"notesControls"\x3e'+(a.vm?'\x3cul class\x3d"notesState notesState-dropdown" data-action\x3d"toggle-note-dropdown"\x3e'+("NEW"==a.note.state?'\x3cli\x3e\x3cspan class\x3d"icon icon--invisible"\x3e\x3c/span\x3ePrivate\x3cspan class\x3d"icon icon--notesStateDown"\x3e\x3c/span\x3e\x3c/li\x3e\x3cli data-action\x3d"approve-note" data-action-value\x3d"'+
z.R(a.note.noteId)+'"\x3e\x3cspan class\x3d"icon icon--group"\x3e\x3c/span\x3ePublic\x3c/li\x3e':"PUBLIC"==a.note.state?'\x3cli\x3e\x3cspan class\x3d"icon icon--group"\x3e\x3c/span\x3ePublic\x3cspan class\x3d"icon icon--notesStateDown"\x3e\x3c/span\x3e\x3c/li\x3e\x3cli data-action\x3d"unapprove-note" data-action-value\x3d"'+z.R(a.note.noteId)+'"\x3e\x3cspan class\x3d"icon icon--invisible"\x3e\x3c/span\x3ePrivate\x3c/li\x3e':"")+(a.RH.userId!=d?'\x3cli data-action\x3d"hide-note" data-action-value\x3d"'+
z.R(a.note.noteId)+'"\x3e\x3cspan class\x3d"icon icon--remove"\x3e\x3c/span\x3eDismiss\x3c/li\x3e':"")+"\x3c/ul\x3e":"PUBLIC"!=a.note.state?'\x3cul class\x3d"notesState"\x3e\x3cli data-tooltip\x3d"'+z.R(v7())+'"\x3e\x3cspan class\x3d"icon icon--invisible"\x3e\x3c/span\x3ePrivate\x3c/li\x3e\x3c/ul\x3e':"")+("PUBLIC"==a.note.state?'\x3cbutton data-action\x3d"show-note-permalink" data-action-value\x3d"'+z.R(a.note.anchor)+"-"+z.R(a.note.noteId)+'" class\x3d"notesLink icon icon--link" data-tooltip\x3d"Click to update the address bar with this note’s shareable link"\x3e':
"")+'\x3c/div\x3e\x3cdiv class\x3d"notesAvatar"\x3e'+z.P(z.RM({user:a.note.author},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e'+(d?'\x3ca href\x3d"/@'+z.R(a.note.author.username)+'" title\x3d"Go to the profile of '+z.R(a.note.author.name)+'"\x3e'+z.L(a.note.author.name)+"\x3c/a\x3e":"\x3ci\x3eUnknown user\x3c/i\x3e")+'\x3c/div\x3e\x3cdiv class\x3d"notesContent"\x3e'+z7(z.P(z.vw(String(a.note.content))))+"\x3c/div\x3e"+(c.isAuthenticated?'\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+
(d==c.currentUser.userId?z.P(z.oF({ba:"button--notesTextAction",action:"edit-note",Da:a.note.noteId,text:"Edit"},c))+z.P(z.oF({isPrimary:!0,wA:!0,ba:"button--editNotesAction",action:"save-note",Da:a.note.noteId,text:"Save"},c))+z.P(z.oF({ba:"button--editNotesAction",action:"cancel-note",Da:a.note.noteId,text:"Cancel"},c))+z.P(z.oF({ba:"button--editNotesAction",action:"delete-note",Da:a.note.noteId,text:"Delete"},c)):"")+"\x3c/div\x3e":"")+"\x3c/div\x3e");var e=a.note.replies.length,g=Math.max(a.note.replies.length-
a.Xm,0);if(e){b+='\x3cdiv class\x3d"notesReplies '+(0<g?"notesReplies--hidden":"")+'"\x3e\x3cdiv class\x3d"notesReplies-inner"\x3e';if(0<g){b+=z.P(z.oF({ba:"button--hiddenNotesReplies",action:"show-hidden-note-replies",text:(0,z.U)("View "+z.L(g)+(a.Xm?" more":"")+(1<g?" replies":" reply"))},c))+'\x3cdiv class\x3d"notesReplies-container"\x3e';for(var h=a.note.replies,k=h.length,m=0;m<k;m++){var q=h[m];b+=m<g?T7(z.N(a,{Af:q}),c):""}b+="\x3c/div\x3e"}h=a.note.replies;k=h.length;for(m=0;m<k;m++)q=h[m],
b+=m>=g?T7(z.N(a,{Af:q}),c):"";b+="\x3c/div\x3e\x3c/div\x3e"}b+='\x3cdiv class\x3d"notesReplies-footer"\x3e'+(c.isAuthenticated?'\x3cdiv class\x3d"notesReply notesReply--creator is-notesEditMode"\x3e\x3cdiv class\x3d"notesAvatar"\x3e'+z.P(z.PM({user:c.currentUser},c))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e\x3ca href\x3d"/@'+z.R(c.currentUser.username)+'" title\x3d"Go to the profile of '+z.R(c.currentUser.name)+'"\x3e'+z.L(c.currentUser.name)+'\x3c/a\x3e\x3c/div\x3e\x3cdiv class\x3d"notesReply-editor notesEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+
z.P(z.oF({isPrimary:!0,wA:!0,ba:"button--editNotesAction",action:"save-reply",Da:a.note.noteId,text:"Save"},c))+z.P(z.oF({ba:"button--editNotesAction",action:"cancel-reply",Da:a.note.noteId,text:"Cancel"},c))+"\x3c/div\x3e\x3c/div\x3e":"")+z.P(z.oF({isPrimary:!0,ba:"button--notesReplyLink",action:"start-reply",source:"new_note_reply",Da:a.note.noteId,md:!0,title:"Leave a reply",text:(0,z.U)(""+(e||!a.note.author?"Reply to conversation":d==c.currentUser.userId?"Leave a reply":"Reply to "+z.L(a.note.author.name)))},
c))+"\x3c/div\x3e\x3c/div\x3e";return(0,z.M)(b)};
var T7=function(a,b){return(0,z.M)('\x3cdiv class\x3d"notesReply"\x3e'+(a.vm&&(null==a.Af.author?null:a.Af.author.userId)!=b.currentUser.userId?'\x3cdiv class\x3d"notesReply-hider" data-action\x3d"hide-reply" data-action-value\x3d"'+z.R(a.note.noteId)+","+z.R(a.Af.replyId)+'" data-tooltip\x3d"Dismiss this reply"\x3e\x3cspan class\x3d"icon icon--remove"\x3e\x3c/span\x3e\x3c/div\x3e':"")+'\x3cdiv class\x3d"notesAvatar"\x3e'+z.P(z.PM({user:a.Af.author},b))+'\x3c/div\x3e\x3cdiv class\x3d"notesAuthor"\x3e'+
(a.Af.author?'\x3ca href\x3d"/@'+z.R(a.Af.author.username)+'" title\x3d"Go to the profile of '+z.R(a.Af.author.name)+'"\x3e'+z.L(a.Af.author.name)+"\x3c/a\x3e":"\x3ci\x3eUnknown user\x3c/i\x3e")+'\x3c/div\x3e\x3cdiv class\x3d"notesContent"\x3e'+z7(z.P(z.vw(String(a.Af.content))))+"\x3c/div\x3e"+(b.isAuthenticated?a.Af.author&&a.Af.author.userId==b.currentUser.userId?'\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+z.P(z.oF({ba:"button--notesTextAction",action:"edit-reply",Da:z.Qq(""+a.note.noteId+
","+(""+a.Af.replyId)),text:"Edit"},b))+z.P(z.oF({isPrimary:!0,wA:!0,ba:"button--editNotesAction",action:"save-reply",Da:a.Af.replyId,text:"Save"},b))+z.P(z.oF({ba:"button--editNotesAction",action:"cancel-reply",Da:a.Af.replyId,text:"Cancel"},b))+z.P(z.oF({ba:"button--editNotesAction",action:"delete-reply",Da:a.Af.replyId,text:"Delete"},b))+"\x3c/div\x3e":"":"")+"\x3c/div\x3e")};
z.HR=function(a,b,c){return(0,z.M)(z.P(z.oF({ba:"notesVote-mobileTapButton",action:"enter-editor-mode",text:(0,z.U)('\x3cdiv class\x3d"u-textMuted notesVoteEditor--wrapper"\x3e\x3cdiv class\x3d"notesVoteEditor notesEditor"\x3e'+z.P((0,z.M)("Tap here to tell the author and your followers why you recommended this story."))+"\x3c/div\x3e\x3c/div\x3e")},c))+z.P(z.lF({isPrimary:!0,Ta:!0,isDisabled:!0,Z:"Send",action:"enter-editor-mode"},c))+z.P(z.lF({Ta:!0,Z:"Skip",action:"exit-editor-mode"},c)))};
z.GR=function(a,b,c){return(0,z.M)(z.P(z.oF({text:(0,z.U)(""+z.P(u7())),ba:"notesVote-mobileTapButton",action:"enter-editor-mode"},c))+z.P(z.pF({icon:"icon--removeMedia",Ta:!0,sb:!0,wf:!0,ba:"noteVote-mobileExitButton",action:"exit-editor-mode"},c)))};
z.nR=function(a,b,c){a=a||{};b=z.M;c=z.P(z.pF({Ta:!0,sb:!0,wf:!0,ba:"noteVote-mobileExitButton",action:"exit-editor-mode",icon:"icon--removeMedia"},c))+'\x3cdiv class\x3d"notesVoteEditor--wrapper js-notesVoteEditorWrapper"\x3e\x3cdiv class\x3d"js-notesVoteEditor notesVoteEditor notesEditor"\x3e\x3c/div\x3e\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+z.P(z.oF({isPrimary:!0,text:(0,z.U)(""+z.P((0,z.M)("Send"))),action:"save-notes-vote"},c))+z.P(z.oF({isPrimary:!0,text:(0,z.U)(""+z.P((0,z.M)("Skip"))),
action:"exit-editor-mode"},c))+'\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"notesVote-message js-notesVoteMessage u-hide"\x3e'+(a.$k&&0!=a.$k?z.P((0,z.M)("Your note will be shared with the author.")):z.P((0,z.M)("Your note will be shared with the author and visible to your "+z.L(c.productName)+" followers.")))+"\x3c/div\x3e";a=a.$k&&0!=a.$k?"":(0,z.M)('\x3cdiv class\x3d"notesVoteSocialShare"\x3e\x3cspan class\x3d"notesVoteSocialShare-prompt"\x3e'+z.P((0,z.M)("Share this story"))+"\x3c/span\x3e"+U7(z.N(null,
{title:(0,z.U)(""+z.P(z.gA())),action:"share-on-twitter",Ze:"post_recommend",icon:"icon--twitter"}))+U7(z.N(null,{title:(0,z.U)(""+z.P(z.hA())),action:"share-on-facebook",Ze:"post_recommend",icon:"icon--facebook"}))+U7(z.N(null,{title:(0,z.U)(""+z.P(z.iA())),action:"share-by-email",Ze:"post_recommend",icon:"icon--email"}))+"\x3c/div\x3e");return b(c+a)};
z.Bca=function(a,b,c){return(0,z.M)(z.P(z.oF({text:(0,z.U)(""+z.P(u7())),ba:"notesVote-mobileTapButton",action:"enter-editor-mode"},c))+'\x3cdiv class\x3d"notesFooter u-noUserSelect"\x3e'+z.P(z.oF({isPrimary:!0,text:(0,z.U)(""+z.P((0,z.M)("Skip"))),action:"exit-editor-mode"},c))+"\x3c/div\x3e")};
var U7=function(a){var b=a.q$?"span":"button";a=""+("\x3c"+z.qr(b)+' class\x3d"button button--chromeless" title\x3d"'+z.R(a.title)+'" data-action\x3d"'+z.R(a.action)+'" data-action-source\x3d"'+z.R(a.Ze)+'"\x3e\x3cspan class\x3d"icon '+z.R(a.icon)+'"\x3e\x3c/span\x3e\x3c/'+z.qr(b)+"\x3e");return(0,z.M)(a)};
var Nda=function(a){var b="";if(10<a.count)b+='\x3cdiv class\x3d"slideIndicator-fraction"\x3e1 of '+z.L(a.count)+"\x3c/div\x3e";else if(1<a.count){b+='\x3cul class\x3d"slideIndicators"\x3e';a=a.count;for(var c=0;c<a;c++)b+='\x3cli class\x3d"slideIndicator"\x3e\x3c/li\x3e';b+="\x3c/ul\x3e"}return(0,z.M)(b)};
var V7=function(a,b,c,d){z.sz.call(this);this.SZ=a;this.Za=b;this.Bc=null;this.zg=c;this.Ca=d;a=window.document.createElement("div");a.className="notesMarkers";z.Pe(a,this.SZ);this.In=a;this.kf={};this.Pp=this.jq=null};
var W7=function(a,b){var c=y7(a.Za,b),d=a.Bc?X7(a.Bc,b):[],e=c?c.ob():0,g=0,h=!1,k=!1,m={},q={};c.Fd(function(a){var b=a.Kz();b&&((a=t7(a))&&a.forEach(function(a){g++;a.author&&(a.author.userId==z.Hi().userId&&(h=!0),a.author.social&&a.author.social.isFollowing&&(m[a.author.userId]=a.author))}),q[b.userId]=!0,b.userId==z.Hi().userId&&(h=!0),b.social&&b.social.isFollowing&&(m[b.userId]=b))});c=z.x.Ga();c.enable_quotes&&c.combined_margin_quotes&&d.forEach(function(a){a=a.user;q[a.userId]=!0;a.userId==
z.Hi().userId&&(k=!0);a.social&&a.social.isFollowing&&!m[a.userId]&&(m[a.userId]=a)});return{postId:a.Ca,Yq:b,Wj:e+g,CA:h,Yr:d.length,NA:k,iP:Object.keys(q).length,j1:z.yb(m)}};
var Y7=function(a,b,c){var d=a.zg.get(b);if(d){var e=a.kf[b];e&&(z.ld(e,"is-active",c),c="left"==z.hp(d,"float")?0:-1*z.yp(d,"margin").right,e.style.left=(z.Bx()||0!==c?c:10)+"px",a=J7(a.zg,b))&&(b=z.Nu(a.className),z.ld(e,"is-notesSourceFloated",2==b||4==b),z.ld(e,"u-hide",z.Px(a,!1)),b=3==b,z.ld(e,"is-notesSourceOutsetCenter",b),a=b||7==z.DB(a),z.ld(e,"is-withoutSocialLine",a))}};var Oda=function(a){var b={};K7(a.zg,function(a,d){if(!(d in b)){var e;e=z.np(a,this.In).y+z.zp(a).top;b[d]=e}},a);return b};
var Z7=function(a){var b=Oda(a),c={};K7(a.zg,function(a,d){if(!c[d]){var h;if(this.kf[d])h=this.kf[d];else{h=W7(this,d);var k=z.wx(Kda,h);this.In.appendChild(k);if(0<h.Wj||0<h.Yr)z.t(a,"is-withNotes"),z.t(k,"is-withNotes");h=this.kf[d]=k}h.style.top=b[d]+"px";Y7(this,d,d==this.Za.bb);c[d]=!0;N7(this.zg,h,a)}},a);for(var d in a.kf)c[d]||(z.Se(a.kf[d]),delete a.kf[d])};var $7=function(a,b,c,d,e){z.aR.call(this,a,b,"Leave a reply",200,d);this.U=a.get("routeBuilder");this.Ca=c;this.jy=e||null};
var a8=function(a){z.tn.call(this);var b=z.Bo();this.Kg=b&&new b8(z.Ip(b,!0),a);this.fj=b&&new b8(z.Ip(b,!1),a)};var b8=function(a,b){this.nf=a;this.RT=b;var c=z.GB(a.ma,b);this.KJ=(this.yg=c)&&c.getAttribute("name");this.Bk=c?z.ky(a,c):-1};var c8=function(a){var b=window.document.body;return z.af(b,a.nf.ma)?a.nf:a.yg&&z.af(b,a.yg)?z.ly(a.Bk,a.yg):a.KJ&&(b=z.iy(a.RT,a.KJ))?z.ly(a.Bk,b):null};
var d8=function(a,b,c){z.qz.call(this);this.SA=a;this.screen=a.get("screen");this.eb=a.get("screenService");this.rF=a.get("app");this.ve=b;this.OM=this.ve.kb().clone();var d;(d=this.ve.kb().pj)&&d.J("change",this.IK,this);this.Bd={};this.Tc=[];this.AF=a.get("butter-bar");this.su=a.get("dialog");this.pc=b=b.pc;this.iL=0;d=b.querySelector(".notesSource");this.anchors=new I7(d);var e=z.Ee("div","layoutSingleColumn notesPositionContainer");z.Qe(this.pc,e,0);this.J2=e;e=window.document.createElement("div");
e.className="notesContainer";z.vx(e,Lda);this.J2.appendChild(e);this.Mf=e;this.gz=b.querySelector(".postField--body");this.Oc=this.Mf.querySelector(".notesList");this.fn=z.Xx(d);this.isAuthenticated=!!z.Ji();this.vm=c;this.data=new x7(a,this.ve.$(),this.ve.Nl);this.data.J("new_note_list",this.PW,this);this.Bc=null;if(this.vo=a.get("voteWidget"))a=this.vo,c=this.data,a.st=c,a.$a()&&(c=c.load(),z.p(z.Wc(z.tR(a),c),a.EJ,a));this.Md=new V7(this.Mf,this.data,this.anchors,this.ve.$());this.Md.N();this.yb=
new z.Ny;this.ou=z.p(this.data.load(),this.HH,this);z.DF(this.Md.In).H("select-anchor",this.IH,this);z.DF(this.Mf).H("show-hidden-note-replies",this.fQ,this).H("start-reply",this.AX,this).H("save-reply",this.kX,this).H("edit-reply",this.rW,this).H("cancel-reply",this.WV,this).H("delete-reply",this.iW,this).H("approve-note",this.RV,this).H("unapprove-note",this.JX,this).H("edit-note",this.qW,this).H("save-note",this.jX,this).H("cancel-note",this.VV,this).H("delete-note",this.hW,this).H("hide-note",
this.zW,this);this.eb.J("historyUpdate",this.IL,this)};var Pda=function(a){if(a.ue&&a.ue.Tu())return!0;for(var b in a.Bd)if(a.Bd[b].Tu())return!0;return!1};var Qda=function(a){var b=new z.Nc,c=a.su.open({title:(0,z.M)("Uh oh!"),bodyHtml:(0,z.M)("You have unsaved notes. Are you sure you want to abandon them?"),type:z.d6});c?(c.J(z.jR,b.nb.bind(b,!0)),c.J(z.kR,function(){this.wO();b.cancel()},a)):b.cancel();return b};var e8=function(a){z.xn(a.ue);a.ue=null;for(var b in a.Bd)z.xn(a.Bd[b]),delete a.Bd[b]};
var f8=function(a,b,c){var d=b.Oj(),e="PUBLIC"==c?(0,z.M)("Note was made public."):"HIDDEN"==c?(0,z.M)("Note was dismissed."):"NEW"==c?(0,z.M)("Note was made private."):"",g=Dda(a.data,b,c);z.r(z.p(g.pe,function(){z.p(this.AF.N(e,{type:z.lV,bw:!0}),function(){g.GQ();f8(this,b,d)},this);g8(this,z.taa,b,{noteState:c,previousNoteState:d})},a),function(a){this.AF.N((0,z.M)("Could not change note state"),"error");g.GQ();(400>a.status||499<a.status)&&f8(this,b,d)},a);return g.pe};
var h8=function(a,b){var c=b.value;return c?a.Bd[c]:a.ue};var Rda=function(a,b){var c=a.ve.pg(a.anchors.get(b));return{text:c.X(),image:4==c.type?c.Zd():null}};
var i8=function(a,b){var c=b||a.Fh,d=a.data.$d(c,a.data.bb),e=a.Oc.querySelector('[data-note-id\x3d"'+c+'"]');z.t(e,"is-showingNotesReplyCreator");var g=a.Bd["reply_"+c];g||(e=e.querySelector(".notesReply-editor"),g=new $7(a.SA,e,a.ve.$(),c),g.J("change",a.Kk,a),g.J("cancel",function(){g.clear()},a),g.J("save",function(a){g.clear();t7(d).push(a);g8(this,z.uaa,d,{replyId:a.td()});G7(this.Ri,d)},a),a.Bd["reply_"+c]=g);g.focus()};
var g8=function(a,b,c,d){d=d||{};d.postId=a.ve.$();d.noteId=c.Lb();d.noteType=c.Ei()?"highlight":"paragraph";z.V(b,d)};var j8=function(a,b,c){var d=z.Bo(),d=d&&L7(a.anchors,z.Gn(d)),e=c&&d&&new a8(d);z.p(k8(a,b&&b.anchor||a.data.bb),function(){if(b!=this.Ej){var a=this.Ej;a&&l8(this,a,!1);b&&l8(this,b,!0);this.Ej=b}(a=e&&e.restore())&&a.select()},a)};
var l8=function(a,b,c){var d=b.anchor,e=J7(a.anchors,d);if(e=a.ve.pg(e)){z.ct(e,4);if(c){if(!Cda(b,e))return;z.Zs(e,z.jt(b.startIndex,b.endIndex,b.id))}a.anchors.get(d).innerHTML=z.Pv(e,z.x,{mode:a.ve.Nl?"edit":"view",isPublished:!!a.ve.kb().Ok(),media:null,sections:!0,Qi:!1,ti:!1,qf:!1})}};
var m8=function(a,b,c){if(b!=a.Fh){c||z.CT(a.rF,"");(c=a.Oc.querySelector(".is-activeNote"))&&z.v(c,"is-activeNote");c=a.Fh=null;if(b&&a.data.bb){var d=a.data.$d(b,a.data.bb);d&&(c=a.Oc.querySelector('[data-note-id\x3d"'+b+'"]'))&&(z.t(c,"is-activeNote"),a.Fh=b,b=(b=d.Ei())?a.data.qr(b):null,j8(a,b||null))}z.ld(a.Oc,"notesItem--selected",!!c)}};
var k8=function(a,b){a.iL=(0,z.Tp)();var c=b!=a.data.bb;if(c&&Pda(a))return z.p(Qda(a),function(){e8(this);return k8(this,b)},a);a.Ej&&(l8(a,a.Ej,!1),a.Ej=null);if(!c)return z.bd();m8(a,null);a.data.bb&&Y7(a.Md,a.data.bb,!1);e8(a);z.xn(a.Ri);a.Ri=null;z.t(a.Oc,"is-hidingNotesEditor");a.data.bb=b&&a.Md.kf[b]?b:"";a.data.bb?a.fu():a.SF();a.Kk();return z.bd()};
var n8=function(a,b,c,d){(b=J7(a.anchors,b))&&(0,z.Ob)(b.querySelectorAll(".markup--quote"),function(a){var b=a.getAttribute("data-creator-ids").split(" "),b=z.$a(b,c);z.ld(a,"is-selected",d&&b)},a)};
var o8=function(a,b){if(a.isAuthenticated){z.xn(a.ue);var c=a.query(".notesItemEditor"),d=null,e=null;if("string"==typeof b)d=b;else if(b instanceof w7)e=b.highlight,d=e.anchor;else throw Error("Missing assoc for note editor");c.innerHTML="";a.ue=new O7(a.SA,c,a.ve.$());Gda(a.ue,d,Rda(a,d));e&&Hda(a.ue,e.startIndex,e.endIndex,e.content);a.ue.J("change",a.Kk,a);a.ue.J("save",a.GH,a);a.ue.J("cancel",function(){y7(this.data,d).ob()?z.t(this.Oc,"is-hidingNotesEditor"):k8(this,null);m8(this,null)},a);
z.v(a.Oc,"is-hidingNotesEditor")}};
var p8=function(a,b,c,d){d8.call(this,a,b,c);this.AM=z.yz(a.get("screen"));this.ab=a.get("dom-monitor");this.ab.J("resize-end",this.Jx,this);this.ab.J("inner-resize-end",this.Jx,this);this.je=a.get("element-tracker");z.DF(this.Mf).H("hide-reply",this.AW,this).H("start-note",this.zX,this).H("show-note-permalink",this.xX,this);d&&(d.J("highlight",this.HL,this),this.Wc=d);[this.anchors.wq].forEach(function(a){this.Tc.push(z.Ex(a,"click",this.rX,this))},this);this.Cx=new z.mL;this.Cx.N();z.wn(this,this.Cx);
Ada(this.Cx,this.oV.bind(this));this.Cx.J("dismiss",this.kW,this)};var q8=function(a){if(a.ue){var b=a.AM,c=b.scrollTop,d=b.scrollLeft;a.ue.focus();b.scrollTop=c;b.scrollLeft=d}};var r8=function(a,b){for(var c=b?1:-1,d=a.parentNode.childNodes,e=d.length,g=(0,z.bb)(d,a),h=z.eC(a,0),k=z.fq(h),h=1!=z.sl(h),m=a,g=g+c;0<=g&&g<e;g+=c){var q=d[g];if("SECTION"===q.tagName){var u=z.eC(q,0),C=z.fq(u),u=1!=z.sl(u);if(k!=C||u||h)break;else m=q}}return m};
var s8=function(a){var b=a.gz.querySelectorAll(".js-is-spacedForNoteList"),c=!1;(0,z.vb)(b,function(a){a.style.paddingBottom="";a.style.paddingTop="";z.v(a,"js-is-spacedForNoteList");c=!0});c&&(Z7(a.Md),a.je.Xh())};var t8=function(a,b){j8(a,b.highlight);u8(a,{scroll:!0,$j:!0});o8(a,b);a.ue&&q8(a);a.S("show")};var Sda=function(a){return!!z.Rx(a,function(a){a=z.QB(a);return 3==a||7==a})};var v8=function(a,b){y7(a.data,b).ob()||(o8(a,b),a.ue&&q8(a))};
var w8=function(a,b){z.p(k8(a,b),function(){v8(this,b);s8(this);x8(this,{scroll:!0,$j:!0});this.Oc.style.top=Math.round(z.Wx(this.Md.kf[b]))+"px";this.Kk()},a)};var Tda=function(a,b,c){if(!a.data.bb)return z.bd(!0);s8(a);var d=z.Wx(b);c&&(d-=z.Vx(c,a.Oc).y);d=Math.round(d+z.zp(b).top);a.Oc.style.top=d+"px";a.Kk();if(1>Math.abs(a.Oc.offsetTop-d)||!(0,z.U5)())return z.bd(!0);b=new z.Nc;z.Dx(a.Oc,z.D1,b.nb.bind(b,a));return b};
var y8=function(a,b,c){var d=a.anchors.get(a.data.bb);if(!a.isAuthenticated){var e=a.data.bb,e=a.Ej?e+("--highlight-"+a.Ej.startIndex+"-"+a.Ej.endIndex):e+"--newNote";a.Oc.querySelector(".button--addNotes").setAttribute("data-redirect",z.EP.EG()+"#"+e)}d&&(e=d.querySelector(".markup--highlight"),d=c.$j&&e?e:d,(e=z.Rx(b,function(a){return z.hd(a,"js-notesList")}))&&(b=e),a=Tda(a,d,b),c.scroll&&z.p(a,function(){z.dy(b,z.Cca)}))};
var u8=function(a,b){var c=a.Oc.querySelector(".newNoteEditor");c&&y8(a,c,b)};var z8=function(a,b,c){b=a.Oc.querySelector('[data-note-id\x3d"'+b+'"]');y8(a,b,c)};var x8=function(a,b){if(a.data.bb){var c=y7(a.data,a.data.bb),d=c.ob();(c=d?c.Eo(0).Lb():null)?(1==d&&m8(a,c),b.$j=!1,z8(a,c,b)):u8(a,b)}};var A8=function(a,b){return b==a.data.bb?z.p(k8(a,null),z.gF):z.p(k8(a,b),z.Yb(!!b))};
var B8=function(a,b,c){var d=z.pf(b.target,"notesItem");!d||b.relatedTarget&&z.af(d,b.relatedTarget)||!(b=a.data.$d(d.getAttribute("data-note-id"),a.data.bb))||(d=null,c?d=b.Ei():a.Fh&&(d=a.data.$d(a.Fh,a.data.bb).Ei()),j8(a,d?a.data.qr(d):null,a.ve.Nl))};var C8=function(a){z.tn.call(this);this.aa=a};var D8=function(a,b){z.qz.call(this);this.aa=a;this.hc=b;this.Cs()};var E8=function(a){a=z.gp(a.hc,"transform").match(/translate3d\(([^,]*)/);return(0,window.parseInt)(a?a[1]:0,10)};
var F8=function(a,b,c,d){var e=b!=a.zy;a.zy=b;a.Dx=b*a.Ay;z.dp(a.hc,"transition-duration",c);z.dp(a.hc,"transform","translate3d("+a.Dx+"px,0,0)");if(e||d){c=b=Math.abs(b);d=a.hc.children;if(10<d.length){if(e=a.hc.parentNode.getElementsByClassName("slideIndicator-fraction")[0])e.innerHTML=c+1+" of "+d.length}else if(d=a.hc.parentNode.getElementsByClassName("slideIndicators")[0])(e=d.getElementsByClassName("is-active")[0])&&z.v(e,"is-active"),(e=d.children[c])&&z.t(e,"is-active");a.S("slide",b,a)}};
var G8=function(a,b,c){d8.call(this,a,b,c);this.CL=this.query(".notesItems");this.qC=a.get("diagnostics");this.hc=new D8(a,this.CL);this.hc.J("slide",this.NL,this);this.Ag=this.yy=null;z.DF(this.Mf).H("dismiss-note",this.HD,this).H("toggle-note-dropdown",function(a){z.md(a.target,"is-open")});this.Tc.push(z.Ex(this.Mf,"click",this.GL,this));this.Tc.push(z.Ex(this.gz,"click",this.GL,this));this.Tc.push(z.Ex(this.Mf,"focusout",this.xW,this))};
var H8=function(a,b){if(a.Ej){var c=a.gz.querySelector(".markup--highlight"),d=a.Oc.querySelector(".is-activeNote");if(d&&c){var d=window.innerHeight-d.offsetHeight+20,e=c.offsetHeight,c=z.Wx(c);e<d&&(c-=(d-e)/2);a.Ag&&a.Ag.cancel();b?a.Ag=new z.WU(a.fn,"scrollTop",200,Math.max(c,0)):z.Ux(a.fn,0,c)}}};var I8=function(a,b){a.hc.enable();z.p(k8(a,b),function(){var a=y7(this.data,this.data.bb).ob();this.yy=z.wx(Nda,{count:a});this.Oc.appendChild(this.yy);F8(this.hc,0,"0",!0)},a)};
var J8=function(a){z.tn.call(this);this.aa=a};var K8=function(a,b){z.tn.call(this);this.Oa=a.get("modelRequest");this.oa=a.get("modelStore");this.ly=a.get("request");this.U=a.get("routeBuilder");this.Ca=b;this.bd=null;this.Cq={};this.qj=new z.cR;this.qj.J("add",this.kN,this);this.qj.J("remove",this.kN,this);z.wn(this,this.qj)};var Uda=function(a,b,c,d){return(0,z.jd)(a.Cq[b.name]||[],function(a){return a.Yb()==c&&a.Fc()==d})};var X7=function(a,b){return L8(a,a.Cq[b]||[])};
var Vda=function(a,b,c,d){b=Uda(a,b,c,d);return L8(a,b)};var M8=function(a,b,c,d){return(a=N8(a,b,c,d))&&a.xa()==z.Hi().userId?a:null};var N8=function(a,b,c,d){a=a.Cq[b.name]||[];if(!a.length)return null;b=null;for(var e=0;e<a.length;e++){var g=a[e];if(!(c<g.Yb()||d>g.Fc())&&(b&&"anon"!=b.xa()||(b=g),g.xa()==z.Hi().userId))return g}return b};var O8=function(a,b){return A7(b,function(a){return a.Eb()[0].getName()},a)};
var L8=function(a,b){b=b.filter(function(a){return"anon"!=a.xa()});var c=A7(b,function(a){return a.xa()},a);return z.yb(c).map(function(a){return new Wda(a[0].Mc(),a)},a)};var Wda=function(a,b){this.user=a;this.quotes=b};
var P8=function(a,b,c){z.sz.call(this);this.Bc=new K8(a,b.$());z.wn(this,this.Bc);var d=this.Bc.qj;d.J("add",this.rM,this);d.J("remove",this.rM,this);this.Ab=b;this.pc=b.aj;this.oj=c;this.oj.Sv(this.Bc);this.gK=[];this.Aa=a.get("app");this.na=a.get("popover");this.ab=a.get("dom-monitor");this.je=a.get("element-tracker");this.U=a.get("routeBuilder")};
var Q8=function(a,b,c,d){var e=R8(a,b);e&&(c=z.h1(z.j1(z.HW(z.i1(z.GW(z.IW(a.na),Ida,e),"top"),c),"popover--dark popover--quoteAttributions"),d).N())&&(c.Pd("deactivate",function(){this.Ek===b&&S8(this,null)},a),z.nM(c).H("quote",a.IU.bind(a,c)).H("quote-respond",a.JU.bind(a,c)))};
var R8=function(a,b){if("anon"==b.xa())return{$a:!1,s1:!0};var c=T8(a,b),d=b.Yb(),e=b.Fc(),c=Vda(a.Bc,c,d,e);if(!c||!c.length)return null;c=(0,z.Ob)(c,function(a){return a.user});d=(0,z.jd)(c,function(a){return a.userId!=z.Hi().userId});return{$a:(0,z.Yc)(c,function(a){return a.userId==z.Hi().userId}),social:d,Oe:c.length}};var Xda=function(a,b){var c=a.pc.querySelectorAll('.markup--quote[name~\x3d"'+b.qg()+'"]');return z.hb(c)};
var T8=function(a,b){var c=b.Eb()[0].name;return(c=z.iy(a.pc,c))?a.Ab.pg(c):null};var U8=function(a,b){var c=z.Do(b);return(c=z.zV(a.oj,c))?N8(a.Bc,c.Qu,c.start,c.end):null};var S8=function(a,b){a.Ek!==b&&(a.Ek&&V8(a,a.Ek,!1),b&&V8(a,b,!0),a.Ek=b)};var V8=function(a,b,c){Xda(a,b).map(function(a){z.ld(a,"is-targeted",c)})};var W8=function(a,b){var c=b.Eb(),d=z.iy(a.pc,c[0].getName()),c=z.iy(a.pc,z.Va(c).getName());(d=z.aF(d,b.Yb(),c,b.Fc()))&&z.HF(a.Pg(),d)};
var Yda=function(a,b,c){var d=(b=zda(a.Ab,b))&&a.Ab.pg(b);if(d){var e=[];c.forEach(function(a){a.Eb()[0].X()!=d.X()&&(a.startOffset=0,a.endOffset=d.X().length);e.push(a)},a);Bda(d,e);b.innerHTML=z.Pv(d,z.x,z.tw)}};var X8=function(a,b,c,d){z.V(c?z.A5:z.yaa,{postId:a.Ab.$(),quoteId:b,source:d})};var Y8=function(a){this.aa=a};z.aR.prototype.Tu=z.Z(144,function(){return this.Bn.trim()!=this.Pa().trim()});z.TU.prototype.Tu=z.Z(143,function(){return this.Bn.trim()!=this.Pa().trim()});
z.hj.prototype.Ov=z.Z(118,function(a){return z.E(this,"highlight",a)});z.hj.prototype.qr=z.Z(117,function(){return z.D(this,"highlight")});z.aj.prototype.xr=z.Z(116,function(){return z.D(this,"quotes")});z.Tl.prototype.xr=z.Z(115,function(){return z.D(this,"quotes")});z.R_.prototype.xr=z.Z(114,function(a){return z.p(this.O.get(z.w(this.U,z.e4,{postId:a}),{background:!0,la:!0}),this.cd.bind(this,z.Ol))});z.Og.prototype.Ei=z.Z(65,function(){return z.D(this,"highlightId")});
z.hj.prototype.Ei=z.Z(64,function(){return z.D(this,"highlightId")});z.mj.prototype.Ei=z.Z(63,function(){return z.D(this,"highlightId")});z.Og.prototype.Ph=z.Z(62,function(){return z.D(this,"authorId")});z.Pg.prototype.Ph=z.Z(61,function(){return z.D(this,"authorId")});z.eh.prototype.Ph=z.Z(60,function(){return z.D(this,"authorId")});z.hj.prototype.Ph=z.Z(59,function(){return z.D(this,"authorId")});z.jj.prototype.Ph=z.Z(58,function(){return z.D(this,"authorId")});
z.km.prototype.Ph=z.Z(57,function(){return z.D(this,"authorId")});z.qg.prototype.Zf=z.Z(32,function(a){return z.E(this,"state",a)});z.Og.prototype.Zf=z.Z(31,function(a){return z.E(this,"state",a)});z.Pg.prototype.Zf=z.Z(30,function(a){return z.E(this,"state",a)});z.ci.prototype.Zf=z.Z(29,function(a){return z.E(this,"state",a)});z.di.prototype.Zf=z.Z(28,function(a){return z.E(this,"state",a)});z.hj.prototype.Zf=z.Z(27,function(a){return z.E(this,"state",a)});
z.jj.prototype.Zf=z.Z(26,function(a){return z.E(this,"state",a)});z.jg.prototype.td=z.Z(18,function(){return z.D(this,"replyId")});z.kg.prototype.td=z.Z(17,function(){return z.D(this,"replyId")});z.Kg.prototype.td=z.Z(16,function(){return z.D(this,"replyId")});z.Pg.prototype.td=z.Z(15,function(){return z.D(this,"replyId")});z.Vh.prototype.td=z.Z(14,function(){return z.D(this,"replyId")});z.Xh.prototype.td=z.Z(13,function(){return z.D(this,"replyId")});
z.Vi.prototype.td=z.Z(12,function(){return z.D(this,"replyId")});z.jj.prototype.td=z.Z(11,function(){return z.D(this,"replyId")});z.nj.prototype.td=z.Z(10,function(){return z.D(this,"replyId")});z.ok.prototype.td=z.Z(9,function(){return z.D(this,"replyId")});z.n(x7,z.qz);z.f=x7.prototype;z.f.load=function(){this.dg||(this.dg=z.r(z.p(this.pi.get(z.w(this.U,z.Z3,{postId:this.Ca}),{la:!0,background:!0}),this.oY,this),z.lz));return this.dg.Sb()};z.f.Li=function(){return this.eK};z.f.Gm=function(){return this.YL};
z.f.pg=function(a){var b=a&&a.getAttribute("name");if(!b||!a)return null;var c=this.yt[b];return c&&!this.Nl?c:this.yt[b]=z.jC(a)};z.f.qr=function(a){return this.TK[a]||null};z.f.$d=function(a,b){return y7(this,b).kr(a)};z.f.AG=function(){return y7(this,"vote")};z.f.DO=function(){var a=z.Hi().userId;return this.AG().find(function(b){return b.Ph()==a})};z.f.Ov=function(a,b){this.TK[a]=b};z.f.rB=function(a){a=z.eB(this.oa,a);y7(this,a.Ec()).add(a)};z.f.$=function(){return this.Ca};
z.f.oY=function(a){var b=a.references.User;this.Zl=b[a.post.creatorId];this.YL=a.post.visibility;var c=a.value;if(c)for(var d=0;d<c.length;d++){var e=c[d];if("HIDDEN"!=e.state){var g=e.replies,h=b;if(g)for(var k=0;k<g.length;k++){var m=g[k],q=m.authorId||null;m.author=q&&h[q]||null}g=e.anchor;h=e.authorId||null;e.author=h&&b[h]||null;g=y7(this,g);e=z.ij(e);g.add(z.eB(this.oa,e))}}if(a=a.highlights)for(b=0;b<a.length;b++)this.Ov(a[b].id,z.gi.mb(z.lj,a[b]));this.eK=!0};
z.f.ia=function(){this.dg.cancel();x7.F.ia.call(this)};z.n(B7,z.sz);z.f=B7.prototype;z.f.pL=function(a){return a.Vb()};z.f.eu=null;z.f.mC=null;z.f.ga=function(){return this.Qa};z.f.L=function(){B7.F.L.call(this);z.tz(this,this.ji,"change",this.fW,this);z.tz(this,this.ji,"add",this.KW,this);z.tz(this,this.ji,"remove",this.LW,this);D7(this,!0)};z.f.fa=function(){this.Qa.innerHTML="";delete this.Qa;B7.F.fa.call(this)};z.f.getData=function(){return this.ji};
z.f.KW=function(a,b){if(this.$a())for(var c=0;c<a.length;c++){var d=b.indexOf(a[c]),d=E7(this,a[c],d);this.S("after-draw",a[c],d)}};z.f.LW=function(a){if(this.$a()){var b=this.Qa.querySelector("#"+H7(this,a));this.S("before-clear",a,b);this.S("destroy",a,b);z.Se(b)}};z.f.fW=function(a){for(var b=0;b<a.length;b++)G7(this,a[b])};I7.prototype.get=function(a){return J7(this,a)};z.n(O7,z.aR);z.f=O7.prototype;z.f.PB=null;z.f.IJ=null;z.f.QB=null;z.f.aD=null;z.f.$C=null;z.f.SK=null;z.f.pG=function(){return z.eR()};z.f.JG=function(){return z.fR()};z.f.FF=function(){return!!this.Lb()};z.f.kp=function(a){var b=z.tx();return(new z.hj({postId:a.postId,anchor:a.anchor,noteId:a.noteId,content:a.content,state:a.state,createdAt:a.createdAt,replies:[],highlight:a.highlight||null,highlightId:a.highlightId||null})).UA(b).hn(b.xa())};z.f.FG=function(){return this.Lb()?"put":"post"};
z.f.Xz=function(){return this.Lb()?z.w(this.U,z.$3,{postId:this.Ca,noteId:this.Lb()}):z.w(this.U,z.Y3,{postId:this.Ca})};z.f.GG=function(a){a={content:a};this.PB&&(a.anchor=this.PB,a.anchorContent=this.IJ,a.anchorImage=this.QB?this.QB.Vb():null);null!=this.aD&&null!=this.$C&&(a.highlightStart=this.aD,a.highlightEnd=this.$C,a.highlightContent=this.SK);return a};z.n(V7,z.sz);z.f=V7.prototype;z.f.Sv=function(a){this.Bc=a;Object.keys(a.Cq).map(this.dw,this);a=a.qj;a.J("add",this.lN,this);a.J("remove",this.lN,this)};z.f.lN=function(a){Object.keys(O8(this.Bc,a instanceof Array?a:[a])).map(this.dw,this)};z.f.dw=function(a){if(this.Za.Li()){var b=a||this.Za.bb;if(a=this.kf[b]){var b=W7(this,b),c=z.x.Ga();c.enable_quotes&&c.combined_margin_quotes?(z.vx(a,R7,b),z.ld(a,"is-withNotes",0<b.Wj||0<b.Yr)):(z.vx(a,R7,b),z.ld(a,"is-withNotes",0<b.Wj))}}};
z.f.PV=function(a){if(a=M7(this.zg,a.target)){var b=J7(this.zg,a),c=this.kf[a];!c||c===this.jq||!b||z.Px(b,!1)||z.hd(b,"postField--insetLeftImage")||z.hd(b,"postField--outsetLeftImage")||(this.jq&&z.v(this.jq,"is-highlighted"),z.t(c,"is-highlighted"),this.jq=c,z.xn(this.Pp),this.Pp=new z.nL(b),this.Pp.gc(c),this.Pp.N(),this.Pp.Pd("dismiss",function(){z.v(c,"is-highlighted");this.jq===c&&(this.jq=null)},this))}};
z.f.L=function(){V7.F.L.call(this);z.xx()||[this.zg.wq].forEach(function(a){this.Ea(a,"mouseover",this.PV)},this)};z.f.Ua=function(){z.xn(this.Pp);z.Se(this.In);this.kf=this.In=null;V7.F.Ua.call(this)};z.n($7,z.aR);z.f=$7.prototype;z.f.pG=function(){return(0,z.M)("Are you sure you want to delete this reply?")};z.f.JG=function(){return(0,z.M)("Your reply is too long; do you want to abandon your changes?")};z.f.FF=function(){return!!this.jy};z.f.kp=function(a){var b=z.tx();return(new z.jj({postId:a.postId,noteId:a.noteId,replyId:a.replyId,content:a.content,createdAt:a.createdAt})).UA(b).hn(b.xa())};z.f.FG=function(){return this.jy?"put":"post"};
z.f.Xz=function(){return this.jy?z.w(this.U,z.c4,{postId:this.Ca,noteId:this.Lb(),replyId:this.jy}):z.w(this.U,z.b4,{postId:this.Ca,noteId:this.Lb()})};z.f.GG=function(a){return{content:a}};z.n(a8,z.zn);a8.prototype.Jv=function(){if(!this.Kg)return null;var a=c8(this.Kg);if(!a)return null;var b=c8(this.fj);return b?z.lo(a.ma,a.offset,b.ma,b.offset):null};z.n(d8,z.qz);z.f=d8.prototype;z.f.ue=null;z.f.Fh=null;z.f.Ej=null;z.f.Ri=null;z.f.Xm=0;z.f.ia=function(){e8(this);k8(this,null);var a;(a=this.ve.kb().pj)&&a.Gb("change",this.IK,this);this.eb.Gb("historyUpdate",this.IL,this);this.zL&&z.Fx(this.zL);z.Fx(this.Tc);this.Tc.length=0;z.tI(this.Md.In);z.tI(this.Mf);z.Se(this.Mf);this.data.Rc();this.ou&&this.ou.cancel();z.xn(this.Md);z.xn(this.yb);this.zL=this.Bc=this.ou=this.data=this.Mf=this.anchors=this.Md=null;d8.F.ia.call(this)};
z.f.Sv=function(a){this.Bc=a;this.Md.Sv(a)};z.f.IK=function(){var a=this.ve.kb();z.x.Ga().enable_recommend_notes&&this.OM.Lo()!=a.Lo()&&(this.OM=a.clone(),!a.Lo()&&(a=this.data.DO()))&&(g8(this,z.z5,a),this.data.AG().remove(a))};z.f.HH=function(){};z.f.DA=function(){};z.f.GH=function(a){a.qr()&&(this.data.Ov(a.Ei(),a.qr()),a.Ov(null));this.data.rB(a);g8(this,z.x5,a)};z.f.IH=function(){};z.f.cQ=function(){};z.f.Kk=function(){};z.f.wO=function(){};z.f.VT=function(a){return a.Vb()};
z.f.AX=function(a){i8(this,a.value)};z.f.kX=function(a){(a=this.Bd["reply_"+a.value])&&a.save()};z.f.WV=function(a){var b=this.Bd["reply_"+a.value];b&&z.bR(b);(a=z.pf(a.target,"notesItem"))&&z.v(a,"is-showingNotesReplyCreator")};
z.f.rW=function(a){function b(){var a=this.data.$d(d,this.data.bb);G7(this.Ri,a);z.v(g,"is-notesEditMode");z.xn(h);delete this.Bd["reply_"+e]}var c=a.value.split(","),d=c[0],e=c[1],c=z.pf(a.target,"notesItem"),g=z.pf(a.target,"notesReply");z.t(g,"is-notesEditMode");z.v(c,"is-showingNotesReplyCreator");a=g.querySelector(".notesContent");var h=new $7(this.SA,a,this.ve.$(),d,e);h.J("save",function(a){for(var c=this.data.$d(d,this.data.bb),g=t7(c),h=0;h<g.length;h++)if(g[h].td()==e){g[h]=a;break}g8(this,
z.vaa,c,{replyId:e});b.call(this)},this);h.J("delete",function(){for(var a=this.data.$d(d,this.data.bb),c=t7(a),g=0;g<c.length;g++)if(c[g].td()==e){z.eb(c,g);break}g8(this,z.waa,a,{replyId:e});b.call(this)},this);h.J("cancel",function(){b.call(this)},this);h.J("change",this.Kk,this);h.focus(!0);this.Bd["reply_"+e]=h};z.f.iW=function(a){(a=this.Bd["reply_"+a.value])&&a.VF()};
z.f.SV=function(a){a=a.Lb();this.Bd[a]&&(z.xn(this.Bd[a]),delete this.Bd[a]);this.Bd["reply_"+a]&&(z.xn(this.Bd["reply_"+a]),delete this.Bd["reply_"+a])};z.f.OV=function(a,b){z.v(b,"is-showingNotesReplyCreator");b.setAttribute("data-note-id",a.Lb())};z.f.RV=function(a){z.r(f8(this,this.data.$d(a.value,this.data.bb),"PUBLIC"),z.ZK(this.su,(0,z.M)("Sorry, we couldn’t approve the note. Please try again later and make sure you are logged in.")))};
z.f.JX=function(a){z.r(f8(this,this.data.$d(a.value,this.data.bb),"NEW"),z.ZK(this.su,(0,z.M)("Sorry, we couldn’t unapprove the note. Please try again later and make sure you are logged in.")))};
z.f.qW=function(a){function b(){z.v(d,"is-notesEditMode");z.xn(g);delete this.Bd[c]}var c=a.value,d=z.pf(a.target,"notesItem");z.t(d,"is-notesEditMode");z.v(d,"is-showingNotesReplyCreator");var e=d.querySelector(".notesContent"),g=new O7(this.SA,e,this.ve.$(),a.value);g.J("save",function(a){this.data.rB(a);g8(this,z.y5,a);b.call(this)},this);g.J("delete",function(){var a=y7(this.data,this.data.bb),d=a.kr(c);g8(this,z.z5,d);a.remove(d);b.call(this)},this);g.J("cancel",function(){var a=this.data.$d(c,
this.data.bb);G7(this.Ri,a);b.call(this)},this);g.J("change",this.Kk,this);g.focus(!0);this.Bd[c]=g};z.f.jX=function(a){(a=h8(this,a))&&a.save()};z.f.VV=function(a){(a=h8(this,a))&&z.bR(a)};z.f.hW=function(a){(a=h8(this,a))&&a.VF()};z.f.QW=function(a){for(var b=0;b<a.length;b++)this.Md.dw(a[b].Ec())};z.f.zW=function(a){var b=a.value,c=this.data.$d(b,this.data.bb);z.r(z.p(f8(this,c,"HIDDEN"),function(){this.DA(c);this.Fh==b&&(this.Fh=null)},this),z.ZK(this.su,(0,z.M)("Sorry, we couldn’t hide the note. Please try again later and make sure you are logged in.")))};
z.f.PW=function(a){a.J("add",this.QW,this);a.J("change",this.cQ,this);a.J("remove",this.DA,this)};z.f.query=function(a){return this.Mf.querySelector(a)};z.f.Ep=function(){Z7(this.Md);this.Md.kf[this.data.bb]||k8(this,null)};z.f.fQ=function(a){this.zI(a)};z.f.zI=function(a){(a=z.pf(a.target,"notesReplies"))&&z.v(a,"notesReplies--hidden")};
z.f.fu=function(){var a=this.data.bb,b=this.query(".notesItems"),c=y7(this.data,a),d=z.x.Ga();if(d.enable_quotes&&d.combined_margin_quotes){var a=this.Bc?X7(this.Bc,a):[],d=this.query(".js-quotesList"),e=z.wx(P7,{YH:a});z.Te(e,d);z.xx()||z.Ex(e,"mouseover",this.OU,this);a.length||z.py(e)}b=new B7(b,c,Mda);b.eL="notesItem";b.pL=this.VT.bind(void 0);D7(b);this.Ri=C7(b,{vm:this.vm,RH:this.data.Zl,Xm:this.Xm});this.Ri.J("before-clear",this.SV,this);this.Ri.J("after-draw",this.OV,this);this.Ri.N();Y7(this.Md,
this.data.bb,!0);z.t(this.screen.V(),"is-notesListVisible");z.Iy(z.saa)};z.f.OU=function(a){if((a=z.Rx(a.target,function(a){return!!a.getAttribute("data-quote-ids")},a.currentTarget))&&this.CJ!=a){this.rn&&this.rn.eO();var b=this.data.bb,c=a.getAttribute("data-quote-creator-id");this.CJ=a;this.rn=new z.nL(J7(this.anchors,b),300);this.rn.gc(a);this.rn.J("dismiss",function(){n8(this,b,c,!1);z.xn(this.rn);this.rn=this.CJ=null},this);this.rn.N();n8(this,b,c,!0)}};
z.f.SF=function(){z.CT(this.rF,"");z.v(this.screen.V(),"is-notesListVisible")};z.f.getSelection=function(a){var b=z.Bo();if(!b||b.isCollapsed())if(a&&(b=a),!b||b.isCollapsed())return null;a=z.Gn(b);var c=L7(this.anchors,a);if(!c)return null;c=(a=z.Rx(a,z.IB,c))&&this.ve.pg(a);if(!a)return null;var d=z.jy(b,a,!0),e=z.jy(b,a,!1);return-1==d||-1==e?null:new w7(b,a,new z.lj({anchor:a.getAttribute("name"),startIndex:d,endIndex:e,content:c.X().substring(d,e)}))};z.f.IL=function(){this.fz(z.YV())};z.n(p8,d8);z.f=p8.prototype;z.f.Xm=3;z.f.Ml=!1;z.f.Wc=null;
z.f.HH=function(){var a=(0,z.Tp)();this.ou=null;this.Ml=!0;var b=z.YV();this.Ep();if(this.isAuthenticated){var c=this.data.Zl.userId===z.Hi().userId;z.ld(this.Oc,"is-notesCreator",c)}z.ff(this.query(".js-notesPostCreator"),this.data.Zl.name);this.fz(b);this.Tc.push(z.Ex(this.Mf,"mouseover",this.cW,this));this.Tc.push(z.Ex(this.Mf,"mouseout",this.bW,this));this.Tc.push(z.Ex(this.Oc,"click",this.XV,this));this.Tc.push(z.Ex(this.gz,z.D1,this.QD,this));z.Jy("notes.renderMarkers",(0,z.Tp)()-a)};
z.f.fz=function(a){if(a.Tf&&this.Md.kf[a.Tf])if("highlight"==a.cr){w8(this,a.Tf);var b=this.anchors.get(a.Tf),c=a.startIndex,d=a.endIndex;if(z.la(c)&&z.la(d)){var e=z.aF(b,c,b,d);e&&(b=new w7(e,b,new z.lj({anchor:a.Tf,startIndex:c,endIndex:d,content:e.X()})),t8(this,b))}}else a.noteId?(z.p(k8(this,a.Tf),function(){v8(this,a.Tf)},this),m8(this,a.noteId,!0),z8(this,a.noteId,{scroll:!0,$j:!0}),"reply"==a.cr&&i8(this)):"newNote"==a.cr&&w8(this,a.Tf)};
z.f.GH=function(a){p8.F.GH.call(this,a);this.ue.clear();m8(this,a.Lb());z.t(this.Oc,"is-hidingNotesEditor")};z.f.wO=function(){var a={scroll:!0,$j:!0};if(this.ue)u8(this,a),q8(this);else{var b=z.xb(this.Bd),c=b&&b.Lb();c&&(m8(this,c),z8(this,c,a),b.focus())}};z.f.fu=function(){p8.F.fu.call(this);N7(this.anchors,this.Mf,this.anchors.get(this.data.bb))};
z.f.Kk=function(){s8(this);var a=(0,window.parseInt)(this.Oc.style.top,10);if(!(0,window.isNaN)(a)){var b=this.data.bb;if(b=b?this.anchors.get(b):null)if(b=z.HB(b,L7(this.anchors,b))){var c=r8(b,!1),b=r8(b,!0),d=!1,e=z.Wx(c);a<e&&(d=e-a,c.style.paddingTop=z.zp(c).top+d+"px",this.Oc.style.top=a+d+"px",z.t(c,"js-is-spacedForNoteList"),d=!0);a+=this.Oc.offsetHeight;c=z.Wx(b)+b.offsetHeight;a>c&&(a-=c,b.style.paddingBottom=z.zp(b).bottom+a+"px",z.t(b,"js-is-spacedForNoteList"),d=!0);d&&(Z7(this.Md),this.je.Xh())}}};
z.f.IH=function(a){z.p(A8(this,a.value),function(a){a&&(this.data.bb&&y7(this.data,this.data.bb).ob()||((a=this.getSelection())&&a.highlight.anchor==this.data.bb?(j8(this,a.highlight),o8(this,a)):o8(this,this.data.bb),this.ue&&q8(this),this.S("show")),x8(this,{scroll:!0,$j:!0}))},this)};z.f.DA=function(a){this.Md.dw(a.Ec());a.Lb()==this.Fh&&j8(this,null)};z.f.zI=function(a){z.v(z.pf(a.target,"notesReplies"),"notesReplies--hidden");this.Kk()};
z.f.rX=function(a){if(!this.ve.Nl&&!Sda(a.target)&&(z.xx()||this.data.bb)){var b=this.getSelection();if(!b||b.Yq!=this.data.bb){if(this.data.bb&&z.xx())return k8(this,null);500>(0,z.Tp)()-this.iL||(a=M7(this.anchors,a.target),z.p(A8(this,a),function(a){var b=this.data.bb;a&&b&&(v8(this,b),x8(this,{scroll:!0,$j:!0}))},this))}}};z.f.Jx=function(){this.Ep()};
z.f.oV=function(a){if(!this.data.bb)return!1;a=a.target;return z.my(a)?!0:!!z.Rx(a,function(a){return a==this.Oc||a==this.Md.In||this.Wc&&a==this.Wc.ga()||a.getAttribute("data-action")&&"zoom"!=a.getAttribute("data-action")}.bind(this))};z.f.kW=function(){this.data.bb&&k8(this,null)};z.f.xX=function(a){z.CT(this.rF,a.value)};z.f.cW=function(a){B8(this,a,!0)};z.f.bW=function(a){B8(this,a,!1)};z.f.HL=function(){if(!this.Wc)return!1;var a=this.getSelection(this.Wc.Rq);z.EF(this.Wc);a&&t8(this,a);return!1};
z.f.AW=function(a){a=a.value.split(",");var b=a[0],c=a[1];z.r(z.p(Eda(this.data,c,b),function(){for(var a=t7(this.data.$d(b,this.data.bb)),e=0;e<a.length;e++)if(a[e].td()==c){z.eb(a,e);break}g8(this,z.xaa,this.data.$d(b,this.data.bb),{replyId:c});this.AF.N((0,z.M)("The reply has been dismissed."),z.lV)},this),z.ZK(this.su,(0,z.M)("Sorry, we couldn’t hide the reply. Please try again later and make sure you are logged in.")))};
z.f.XV=function(a){a=a.target;var b=z.pf(a,"notesItem");if(b){var c=b.getAttribute("data-note-id");c==this.Fh?z.Rx(a,function(a){return!!a.getAttribute("data-action")||z.hd(a,"editable")},b,!0)==b&&m8(this,null):(m8(this,c),z8(this,c,{scroll:!0,$j:!0}))}};z.f.zX=function(){var a=this.getSelection();m8(this,null);a&&j8(this,a.highlight);o8(this,a||this.data.bb);this.ue&&(a&&u8(this,{scroll:!0,$j:!0}),q8(this))};
z.f.QD=function(a){(a=a.target.getAttribute("name"))&&J7(this.anchors,a)&&Y7(this.Md,a,a==this.data.bb)};z.f.Ep=function(){if(this.Ml){if(this.Of)return z.By(Error("UpdatePositions called after dispose"));p8.F.Ep.call(this);var a={scroll:!1,$j:!0};this.Fh?z8(this,this.Fh,a):x8(this,a)}};z.f.q2=function(){if(this.data.bb){var a=this.anchors.get(this.data.bb);if(!a)k8(this,null);else if(!this.ve.Nl){var b=z.Bo();b&&(b=z.Gn(b),z.af(a,b)||k8(this,null))}}};
z.f.ia=function(){this.ab.Gb("resize-end",this.Jx,this);this.ab.Gb("inner-resize-end",this.Jx,this);this.Wc&&this.Wc.Gb("highlight",this.HL,this);p8.F.ia.call(this)};z.n(C8,z.tn);C8.prototype.KF=function(a,b,c,d){return new p8(a.Ha(),b,c,d)};z.n(D8,z.qz);z.f=D8.prototype;z.f.xt=0;z.f.VD=0;z.f.gk=0;z.f.pC=0;z.f.Dx=0;z.f.jL=0;z.f.co=0;z.f.vE=1;z.f.Ay=0;z.f.zy=0;z.f.zM=0;z.f.ii=void 0;z.f.cb=[];z.f.Cs=function(){this.cb.length||(this.cb=[z.Ex(this.hc,"touchstart",this.IX,this),z.Ex(this.hc,"touchmove",this.PD,this),z.Ex(this.hc,"touchend",this.HX,this)])};
z.f.IX=function(a){var b=this.hc.firstChild;this.pC=this.gk=0;this.zM=b.offsetWidth*this.hc.children.length;this.ii=void 0;this.Ay=this.hc.offsetWidth;this.vE=1;this.jL=-(this.hc.children.length-1);this.co=+new Date;this.xt=a.touches[0].pageX;this.VD=a.touches[0].pageY;z.dp(this.hc,"transition-duration",0)};
z.f.PD=function(a){1<a.touches.length||(this.gk=a.touches[0].pageX-this.xt,this.pC=a.touches[0].pageY-this.VD,this.xt=a.touches[0].pageX,this.VD=a.touches[0].pageY,"undefined"==typeof this.ii&&(this.ii=Math.abs(this.pC)>Math.abs(this.gk)),this.ii||(this.Dx=this.gk/this.vE+E8(this),a.preventDefault(),this.vE=0===this.zy&&0<this.gk?this.xt/this.Ay+1.25:this.zy==this.jL&&0>this.gk?Math.abs(this.xt)/this.Ay+1.25:1,z.dp(this.hc,"transform","translate3d("+this.Dx+"px,0,0)")))};
z.f.HX=function(){if(!this.ii){var a=1E3>+new Date-this.co&&15<Math.abs(this.gk)?0>this.gk?-1:1:0,b=Math[a?0>this.gk?"ceil":"floor":"round"](E8(this)/(this.zM/this.hc.children.length)),b=Math.min(b+a,0),b=Math.max(-(this.hc.children.length-1),b);F8(this,b,".2s")}};z.f.disable=function(){z.dp(this.hc,"transition-duration","0");z.dp(this.hc,"transform","translate3d(0,0,0)");z.Fx(this.cb);this.cb=[]};z.f.enable=D8.prototype.Cs;z.n(G8,d8);z.f=G8.prototype;z.f.ia=function(){this.CL=null;this.hc&&(this.hc.disable(),this.hc.Gb("slide",this.NL,this),this.hc=null);this.Ag&&(this.Ag.cancel(),this.Ag=null);G8.F.ia.call(this)};z.f.fu=function(){G8.F.fu.call(this);s7(this.qC,!0)};z.f.SF=function(){s7(this.qC,!1);G8.F.SF.call(this)};
z.f.HH=function(){this.ou=null;var a=(0,z.Tp)(),b=z.YV();this.Ep();if(this.isAuthenticated){var c=this.data.Zl.userId===z.Hi().userId;z.ld(this.Oc,"is-notesCreator",c)}z.ff(this.query(".js-notesPostCreator"),this.data.Zl.name);this.fz(b);z.Jy("notes.renderMarkers",(0,z.Tp)()-a)};z.f.fz=function(a){a.Tf&&this.Md.kf[a.Tf]&&a.noteId&&this.data.$d(a.noteId,a.Tf)&&I8(this,a.Tf)};z.f.cQ=function(){};
z.f.fQ=function(a){this.zI(a);z.t(this.fn,"is-showingNotesReplies");this.hc.disable();C7(this.Ri,{vm:this.vm,RH:this.data.Zl,Xm:window.Infinity})};z.f.IH=function(a){a=a.value;this.Md.kf[a]&&(a==this.data.bb?k8(this,null):I8(this,a))};z.f.DA=function(a){this.Md.dw(a.Ec());if(!this.data.bb||!y7(this.data,this.data.bb).ob())return this.HD();F8(this.hc,0,"0")};z.f.xW=function(){H8(this,!0)};z.f.GL=function(a){this.data.bb&&!z.af(this.Oc,a.target)&&(a.stopPropagation(),this.HD())};
z.f.NL=function(a){if(a=y7(this.data,this.data.bb).Eo(a)){m8(this,a.Lb());if(!a.Ei()){a=a.Ec();var b=this.anchors.get(a),b=z.Mx(b);j8(this,new z.lj({anchor:a,startIndex:0,endIndex:b.length-1,content:b}),!0)}H8(this,!0)}};
z.f.HD=function(){z.hd(this.fn,"is-showingNotesReplies")?z.hd(this.fn,"is-showingNotesReplies")&&(z.t(this.Oc.querySelector(".is-activeNote .notesReplies"),"notesReplies--hidden"),z.v(this.fn,"is-showingNotesReplies"),this.hc.enable(),F8(this.hc,0,"0",!0),H8(this,!1),C7(this.Ri,{vm:this.vm,RH:this.data.Zl,Xm:this.Xm})):z.p(k8(this,null),function(){z.v(this.fn,"is-showingNotesReplies");z.v(this.fn,"is-newNoteEditorActivated");z.v(this.Mf,"is-showingNewNoteEditor");z.v(this.screen.V(),"is-notesListVisible");
s7(this.qC,!1);this.yy&&z.Se(this.yy);this.hc.disable();this.Ep()},this)};z.n(J8,z.tn);J8.prototype.KF=function(a,b,c){return new G8(a.Ha(),b,c)};z.n(K8,z.tn);z.f=K8.prototype;z.f.load=function(){this.bd||(this.bd=z.p(this.Oa.xr(this.Ca),this.uU,this));return this.bd.Sb()};z.f.toggle=function(a,b,c,d){var e=N8(this,a,b,c);return e&&e.xa()==z.Hi().userId?this.remove(e):e&&d?this.create(a,e.Yb(),e.Fc()):this.create(a,b,c)};z.f.kG=function(a,b,c){var d=M8(this,a,b,c);return d?z.bd(d):(d=N8(this,a,b,c))?this.create(a,d.Yb(),d.Fc()):this.create(a,b,c)};
z.f.create=function(a,b,c){return z.p(this.ly.post(z.w(this.U,z.e4,{postId:this.Ca}),{paragraphs:[a.mb().Vb()],startOffset:b,endOffset:c},{la:!0}),function(a){a=z.eB(this.oa,z.Rj(a.value));this.qj.add(a);return a},this)};z.f.remove=function(a){this.qj.remove(a);this.oa.remove(a);return z.p(this.ly.Vd(z.w(this.U,z.f4,{postId:this.Ca,quoteId:a.qg()})),function(){return a},this)};z.f.uU=function(a){z.YA(this.oa,a);this.qj.me(a.value||[]);return this.qj};z.f.kN=function(){this.Cq=O8(this,this.qj.Cd())};z.n(P8,z.sz);z.f=P8.prototype;z.f.Pg=function(){return this.oj.Pg()};z.f.L=function(){P8.F.L.call(this);this.Ea(this.pc,"click",this.at,this);z.EV(this.Ab)&&z.Ax()&&this.Ea(this.pc,"mouseover",this.DU,this);z.r(this.Bc.load(),z.lz);var a=this.Pg();a&&(z.tz(this,a,"quote",this.yU,this),z.tz(this,a,"quote-respond",this.zU,this),z.tz(this,a,"show",this.bF,this),z.tz(this,a,"hide",this.BW,this));z.Ji()&&z.Ax()&&z.tz(this,this.ab,"scroll-end",this.kj,this)};
z.f.at=function(a){z.Rx(a.target,function(a){if(a===this.pc)return!0;var c=z.QB(a);if(3==c)return!0;if(7==c){if(c=U8(this,a))if(S8(this,c),z.Ax())W8(this,c);else{var d=new z.mL;Q8(this,c,a,d)}return!0}return!1}.bind(this))};
z.f.DU=function(a){z.Rx(a.target,function(a){if(a===this.pc)return!0;var c=z.QB(a);if(3==c)return!0;if(7==c){c=z.Bo();if(!(c&&!c.isCollapsed()||this.Pg()&&this.Pg().$o()||(c=this.na.Kb(),c&&z.hd(c.V(),"js-quoteOnboarding")))&&(c=U8(this,a))){var d=this.pc.querySelector('.markup--quote[name~\x3d"'+c.qg()+'"]');a=new z.nL(a,100);Q8(this,c,d,a);S8(this,c)}return!0}return!1}.bind(this))};
z.f.bF=function(){var a=z.Bo();a&&!a.isCollapsed()&&S8(this,null);if(z.EV(this.Ab)&&(a=z.zV(this.oj,this.Pg().Rq))){var a=M8(this.Bc,a.Qu,a.start,a.end),b=this.Pg().ga().querySelector(".js-highlightMenuQuoteButton");z.ld(b,"is-active",!!a)}};z.f.BW=function(){this.Ek&&S8(this,null)};
z.f.yU=function(){if(z.EV(this.Ab)){var a=z.zF(this.Pg());if(a){var b=a.range,c=a.V1,a=this.Pg().ga().querySelector(".js-highlightMenuQuoteButton"),d=z.hd(a,"is-active"),b=z.zV(this.oj,b);z.r(z.p(this.Bc.toggle(b.Qu,b.start,b.end,!c),function(a){z.Go();d?z.EF(this.Pg()):W8(this,a);var b=c?"selection_menu":"quote_click_menu";X8(this,a.qg(),!d,b)},this),z.lz)}}};
z.f.zU=function(){if(z.FV(this.Ab)){var a=z.zF(this.Pg());a&&(a=z.zV(this.oj,a.range),z.r(z.p(this.Bc.kG(a.Qu,a.start,a.end),function(a){X8(this,a.qg(),!0,"selection_menu_quote_respond");this.Aa.navigate(z.w(this.U,z.zw,{},{inResponseToQuoteId:a.quoteId}))},this),z.lz))}};
z.f.IU=function(a){var b=this.Ek,c=T8(this,b),d=b.Yb(),e=b.Fc(),b=a.query(".js-quoteAttributions-pileOn"),g=z.hd(b,"is-active");z.r(z.p(this.Bc.toggle(c,d,e,!0),function(b){var k=a.query(".js-quoteAttributions-pileOn");z.md(k,"is-active");if(k=N8(this.Bc,c,d,e)){var m=R8(this,k),q=a.query(".js-quoteAttributions-info");z.vx(q,Q7,m)}else a.fb();!g&&z.Ax()&&(a.fb(),W8(this,k));k=z.Ax()?"quote_hover":"quote_click_mobile";X8(this,b.qg(),!g,k)},this),z.lz)};
z.f.JU=function(){if(z.FV(this.Ab)){var a=T8(this,this.Ek),b=this.Ek.Yb(),c=this.Ek.Fc();z.r(z.p(this.Bc.kG(a,b,c),function(a){X8(this,a.qg(),!0,"quote_respond");this.Aa.navigate(z.w(this.U,z.zw,{},{inResponseToQuoteId:a.quoteId}))},this),z.lz)}};z.f.rM=function(){var a=new a8(this.pc),b=this.Bc.Cq,c=Object.keys(b).concat(this.gK);z.mb(c);c.forEach(function(a){Yda(this,a,b[a]||[])},this);this.gK=Object.keys(b);(a=a.restore())&&a.select();z.Ji()&&z.Ax()&&this.kj()};
z.f.kj=function(){var a=this.pc.querySelector(".markup--quote.is-other");if(a){var b=z.Ez(this.je),c=this.je.track(a).Yc();if(b.contains(c)&&(b=new z.sy("quotes"),!b.get("quotes-onboarding"))){var d=z.j1(z.i1(z.HW(z.GW(z.IW(this.na),Jda),a),"top"),"popover--onboarding popover--quoteOnboarding js-quoteOnboarding").N();z.nM(d).H("done",function(){d.fb()});b.put("quotes-onboarding",!0);this.ab.Gb("scroll-end",this.kj,this)}}};Y8.prototype.n0=function(a,b){return new P8(this.aa,a,b)};var Z8=z.cT;Z8.Ha().scope("screen").add("notes",C8).add("notes-mobile",J8).add("quotes",Y8);z.g6(Z8,"notes");})(_mdm);
